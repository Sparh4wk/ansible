gid: "{{ ansible_user_gid }}"
uid: "{{ ansible_user_uid }}"

mountpoints:
  - path: /
    src: UUID=574b5921-91aa-4a2f-925f-4fab7fe8c24e
    fstype: btrfs
    opts: subvol=@ # user,subvol=@
    state: mounted

docker:
  # Aria2c
  - name: aria2
    image: abcminiuser/docker-aria2-with-webui
    volumes:
      - /data/downloads:/data
      - /data/config/aria2:/config
    ports:
      - 6880:80
      - 6800:6800
    env:
      PUID: "{{ uid }}"
      PGID: "{{ gid }}"
      SECRET: F4ysBecV9Sr5qt5bVxtytehDT7PJ92RHd4u567kkQo9UmBpzQig3HmJvYejiw2A4

  # ArchiSteamFarm
  - name: asf
    image: justarchi/archisteamfarm
    user: "{{ uid }}:{{ gid }}"
    volumes:
     - /data/config/asf:/app/config
    restart_policy: on-failure
    state: stopped

  # Duplicati
  - name: duplicati
    image: linuxserver/duplicati
    volumes:
      - /data/config/duplicati:/config
      - /data:/source
    ports:
      - 8200:8200
    env:
      PGID: "{{ gid }}"
      PUID: "{{ uid }}"

  # Jackett
  - name: jackett
    image: linuxserver/jackett
    state: stopped
    restart_policy: on-failure
    volumes:
      - /data/config/jackett:/config
      - /data/downloads:/downloads
    ports:
      - 9117:9117
    env:
      PGID: "{{ gid }}"
      PUID: "{{ uid }}"

  # JDownloader 2
  - name: jdownloader2
    image: jlesage/jdownloader-2
    volumes:
      - /data/config/jdownloader2:/config
      - /data/downloads:/output
    ports:
      - 5800:5800
    env:
      USER_ID: "{{ uid }}"
      GROUP_ID: "{{ gid }}"

  # QBittorrent
  - name: qbittorrent
    image: linuxserver/qbittorrent
    volumes:
      - /data/config/qbittorrent:/config
      - /data/downloads:/downloads
    ports:
      - 6881:6881
      - 6881:6881/udp
      - 8080:8080
    env:
      PGID: "{{ gid }}"
      PUID: "{{ uid }}"

  # Radarr
  - name: radarr
    image: linuxserver/radarr
    volumes:
      - /data/config/radarr:/config
      - /data/downloads:/downloads
    ports:
      - 7878:7878
    env:
      PGID: "{{ gid }}"
      PUID: "{{ uid }}"

  # Samba
  - name: samba
    image: dperson/samba
    volumes:
      - /data:/share/
    ports:
      - 139:139
      - 445:445
    env:
      USERID: "{{ uid }}"
      GROUPID: "{{ gid }}"
    command:
      - -s "data;/share;yes;no;yes"
      - -g "hosts allow = 192.168.1."
      - -g "acl allow execute always = yes"

  # Sonarr
  - name: sonarr
    image: linuxserver/sonarr
    volumes:
      - /data/config/sonarr:/config
      - /data/downloads:/downloads
    ports:
      - 8989:8989
    env:
      PGID: "{{ gid }}"
      PUID: "{{ uid }}"

  # Syncthing
  - name: syncthing
    image: linuxserver/syncthing
    volumes:
      - /data/config/syncthing:/config
      - /data/syncthing:/data
    network_mode: host
    env:
      PGID: "{{ gid }}"
      PUID: "{{ uid }}"

  # Kamera - Terasa
  - name: kamera-terasa
    image: jrottenberg/ffmpeg
    user: "{{ uid }}:{{ gid }}"
    volumes:
      - /data/kamera/terasa:/output
    command:
      - -loglevel error
      - -rtsp_transport tcp
      - -i rtsp://admin:1234567a@192.168.1.250:554//Streaming/Channels/1
      - -c copy
      - -segment_time 3600
      - -segment_atclocktime 1
      - -strftime 1
      - -f segment /output/%d-%m_%H-%M.ts

  # Kamera - Vpredu
  - name: kamera-vpredu
    image: jrottenberg/ffmpeg
    user: "{{ uid }}:{{ gid }}"
    volumes:
      - /data/kamera/vpredu:/output
    command:
      - -loglevel error
      - -rtsp_transport tcp
      - -i rtsp://admin:1234567a@192.168.1.251:554//Streaming/Channels/1
      - -c copy
      - -segment_time 3600
      - -segment_atclocktime 1
      - -strftime 1
      - -f segment /output/%d-%m_%H-%M.ts

  # Kamera - Zahon
  - name: kamera-zahon
    image: jrottenberg/ffmpeg
    user: "{{ uid }}:{{ gid }}"
    volumes:
      - /data/kamera/zahon:/output
    command:
      - -loglevel error
      - -rtsp_transport tcp
      - -i rtsp://admin:1234567a@192.168.1.252:554//Streaming/Channels/1
      - -c copy
      - -segment_time 3600
      - -segment_atclocktime 1
      - -strftime 1
      - -f segment /output/%d-%m_%H-%M.ts

  # Kamera - Pristresek
  - name: kamera-pristresek
    image: jrottenberg/ffmpeg
    user: "{{ uid }}:{{ gid }}"
    volumes:
      - /data/kamera/pristresek:/output
    command:
      - -loglevel error
      - -rtsp_transport tcp
      - -i rtsp://admin:1234567a@192.168.1.253:554//Streaming/Channels/1
      - -c copy
      - -segment_time 3600
      - -segment_atclocktime 1
      - -strftime 1
      - -f segment /output/%d-%m_%H-%M.ts

  # Kamera - Najezd
  - name: kamera-najezd
    image: jrottenberg/ffmpeg
    user: "{{ uid }}:{{ gid }}"
    volumes:
      - /data/kamera/najezd:/output
    command:
      - -loglevel error
      - -rtsp_transport tcp
      - -i rtsp://admin:1234567a@192.168.1.254:554//Streaming/Channels/1
      - -c copy
      - -segment_time 3600
      - -segment_atclocktime 1
      - -strftime 1
      - -f segment /output/%d-%m_%H-%M.ts
